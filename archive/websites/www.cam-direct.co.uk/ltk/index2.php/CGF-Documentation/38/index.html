
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>The Borg Matrix - CGF-Documentation</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="keywords" content="License, Kill, Borg, Matrix, games, Quake 2, ltktbm, action, free, openal, ">
<META name="description" content="The Borg Matrix, Economics Modelling, Financial Management, Strategic planning and PC gaming for windows and Linux">
<meta http-equiv='Page-Enter' content='blendTrans(Duration='100')'><link rel="stylesheet" type="text/css" href="/ltk/stdtheme.css" >
<link rel="stylesheet" href="/ltk/menu.css" />
<!--[if IE]>
<link rel="stylesheet" href="/ltk/menuie.css" />
<script type="text/javascript">
window.mlrunShim = true;
</script>
<![endif]-->
<script type="text/javascript" src="/ltk/topmenu.js">
</script>
</head>

<body bgcolor="#000000">
<div align="center"><font color="#FFFFFF">The Borg Matrix, Economics Modelling, Financial Management, Strategic planning and PC gaming for windows and Linux</font></div>
<div align="center"><font color="#FFFFFF">
<script language="JavaScript"> TargetDate = "11/07/2006 9:00 PM"; BackColor = "black"; ForeColor = "white"; CountActive = true; CountStepper = 1; LeadingZero = true; DisplayFormat = "%%D%% Days, %%H%% Hours, %%M%% Minutes, %%S%% Seconds."; </script> <script language="JavaScript" src="countdown.js"></script>


</font></div>
<!--begin header text-->
<table align="center"><TR>
<td align="right" class="maintitle"><img src="/ltk/images/ltkbanner2.gif" width="400" height="106" alt="AQ2 LTKTBM Edition"></td>
<td class="maintitle">
<form method=GET action="/ltk/index2.php">
<input type=hidden name=location value="Dictionary">
<input type=text name=word size=25 maxlength=2048 value=""><BR><font size=-1>
<input type=submit value="Dictionary Search"><span id=hf></span></font>
</form>
</td><TD><!-- SiteSearch Google -->
<form method="get" action="http://www.google.com/custom" target="_top">
<table border="0" bgcolor="#000000">
<tr><td nowrap="nowrap" valign="top" align="left" height="32">
<a href="http://www.google.com/">
<img src="http://www.google.com/logos/Logo_25blk.gif" border="0" alt="Google" align="middle"></img></a>
<br/>
<input type="hidden" name="domains" value="www.cam-direct.co.uk"></input>
<label for="sbi" style="display: none">Enter your search terms</label>
<input type="text" name="q" size="31" maxlength="255" value="" id="sbi"></input>
</td></tr>
<tr>
<td nowrap="nowrap">
<table>
<tr>
<td>
<input type="radio" name="sitesearch" value="" checked id="ss0"></input>
<label for="ss0" title="Search the Web"><font size="-1" color="#ffffff">Web</font></label></td>
<td>
<input type="radio" name="sitesearch" value="www.cam-direct.co.uk" id="ss1"></input>
<label for="ss1" title="Search www.cam-direct.co.uk"><font size="-1" color="#ffffff">www.cam-direct.co.uk</font></label></td>
</tr>
</table>
<label for="sbb" style="display: none">Submit search form</label>
<input type="submit" name="sa" value="Search" id="sbb"></input>
<input type="hidden" name="client" value="pub-7138831479577622"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="safe" value="active"></input>
<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:000000;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:50;LW:203;L:http://www.cam-direct.co.uk/ltk/images/ltkbanner2.gif;S:http://;FORID:1"></input>
<input type="hidden" name="hl" value="en"></input>
</td></tr></table>
</form>
<!-- SiteSearch Google --></TD></tr></td>
</TR></table>
<!--end header text-->
<!--begin layout table-->

<table width="100%" align="center" border="0" cellspacing="1" cellpadding="0">
<tr bgcolor="#006600" class="maintitle">
<td align="center" class="maintitle"  width="70%"><font size="+3"><b>CGF-Documentation</b></font></td>
<td align="center" class="maintitle">
<STRONG>Not Logged in : </STRONG><a href="http://www.cam-direct.co.uk/phpBB2/login.php?&sid=48946b0762ebb34a39089e2b5ec5d34b">Login</a> | <a href="http://www.cam-direct.co.uk/phpBB2/profile.php?mode=register&sid=48946b0762ebb34a39089e2b5ec5d34b">Register</a> </td>
</tr>
</table>
<table width="100%" align="center" border="0" cellspacing="1" cellpadding="0">
<tr> 
    <td width="80%" valign="top"> 
<!--begin main text-->
<table width="100%">
<tr>
<td class="maintitle" align="center"><div class='mlmenu horizontal fade arrow greenwhite delay inaccesible' align='center' valign='center'><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Main/1'>Main</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/LTKTBM Main/60'>LTKTBM Main</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/3'>Media</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/4'>Docs</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/61'>AQ2</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Contents/21'>Contents</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Readme/22'>Readme</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/AQ2-Commands/23'>AQ2-Commands</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Weapons-and-Items/24'>Weapons-and-Items</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Credits/25'>Credits</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/System-Requirements/47'>System-Requirements</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Changelog/53'>Changelog</a></li><li><a href='http://slacker.home.cosmic-cow.net/confgen/' target='blank'>Config generator</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Wealth of Nations/62'>Wealth of Nations</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Wealth of Nations/63/1/1' onmouseover="return escape('THE CAUSES OF IMPROVEMENT IN THE PRODUCTIVE POWERS OF LABOUR, AND OF THE ORDER ACCORDING TO WHICH ITS PRODUCE IS NATURALLY DISTRIBUTED AMONG THE DIFFERENT RANKS OF THE PEOPLE')" target='_SELF'>Book 1</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Wealth%20of%20Nations/93/2/1' onmouseover="return escape('THE NATURE, ACCUMULATION, AND EMPLOYMENT OF STOCK')" target='_SELF'>Book 2</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Wealth%20of%20Nations/94/3/1' onmouseover="return escape('THE DIFFERENT PROGRESS OF OPULENCE IN DIFFERENT NATIONS')" target='_SELF'>Book 3</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Wealth%20of%20Nations/95/4/1' onmouseover="return escape('SYSTEMS OF POLITICAL ECONOMY')" target='_SELF'>Book 4</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Wealth%20of%20Nations/96/5/1.1.1' onmouseover="return escape('THE REVENUE OF THE SOVEREIGN OR COMMONWEALTH')" target='_SELF'>Book 5</a></li></ul></li></ul></li><li><a href='http://aqmd.telefragged.com/' target='_blank'>maps</a></li><li><a href='http://mods.moddb.com/gallery/964/' target='_blank'>Screenshots</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/20'>Gun-Radio_Interview_Transcript</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Interview-Part-1/26'>Interview-Part-1</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Interview-Part-2/27'>Interview-Part-2</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Stories/50'>Stories</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Story-City/51'>Story-City</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Ragdol-Physics/55'>Ragdol-Physics</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Water-Engine/56'>Water-Engine</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/6'>Downloads</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/LTKTBM/7'>LTKTBM</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Updates/8'>Updates</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Routes/9'>Routes</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Others/10'>Others</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Music/6'>Music</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/News/11'>News</a><ul><li><a href='http://www.cam-direct.co.uk/phpBB2/viewtopic.php?t=3&postdays=0&postorder=desc'>Interim_News</a></li><li><a href='http://www.cam-direct.co.uk/phpBB2/privmsg.php?mode=post&u=1'>Submit_News</a></li><li><a href='http://www.cam-direct.co.uk/ltk/newswire.php'>Global Newswire</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/phpBB2/index.php'>Forums</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/IRC/14'>IRC</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Plans/15'>Plans</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/16'>Developers</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/31'>Game_Engine</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Ragdol-Physics/32'>Ragdol-Physics</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Ragdol-Readme/33'>Ragdol-Readme</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Secure-Client-Identification/43'>Secure-Client-Identification</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/openAL/44'>openAL</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/openAL-tutorial-for-Q2E/45'>openAL-tutorial-for-Q2E</a></li><li><a href='http://www.cam-direct.co.uk/phpBB2/viewforum.php?f=23'>openAL/eax_developement_discussion</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Water-Engine/52'>Water-Engine</a></li><li><a href='http://www.cam-direct.co.uk/phpBB2/privmsg.php?mode=post&u=1'>Engine source request</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Artificial_Intelligence/37'>Artificial_Intelligence</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/The_Borg_Matrix/28'>The_Borg_Matrix</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/30'>Agent_Economics</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/milliEcon-v2/29'>milliEcon-v2</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/milliEcon-v1/36'>milliEcon-v1</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Game_of_Life-Earth/35'>Game_of_Life-Earth</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/phpBB2/viewforum.php?f=7&location=The_Borg_Matrix&expand=28'>Pathfinder</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/Dictionary/42'>Dictionary</a></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/TBM_vs_Others/49'>TBM_vs_Others</a></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/38'>CGF-Documentation</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/downloads/dl.php?id=114' target='_blank'>CGF_Grenade_Handling</a></li><li><a href='http://www.cam-direct.co.uk/ltk/downloads/dl.php?id=115' target='_blank'>CGF_Terrain_Handling</a></li></ul></li></ul></li></ul></li><li><a href='http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/38'>|CGF-Documentation|</a><ul><li><a href='http://www.cam-direct.co.uk/ltk/downloads/dl.php?id=114' target='_blank'>CGF_Grenade_Handling</a></li><li><a href='http://www.cam-direct.co.uk/ltk/downloads/dl.php?id=115' target='_blank'>CGF_Terrain_Handling</a></li></ul></ul></div></td></tr></table>
<div align="center"><script type="text/javascript"><!--
google_ad_client = "pub-7138831479577622";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "000000";
google_color_bg = "000000";
google_color_link = "FFFFFF";
google_color_text = "CCCCCC";
google_color_url = "999999";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div><br><table width='95%' align='center' border='0' cellspacing='1' cellpadding='0' bgcolor='#345487'><tr><td>
<table width='100%' border='0' cellspacing='0' cellpadding='3' class='maintitle'><tr><td class='maintitle'><img src='/forums/style_images/1/nav_m.gif' border='0'  alt='' width='8' height='8'></td>
<td width='100%' class='maintitle'>CGF Documentation</td>
</tr></table></td></tr><tr><td class='mainbg'><table width='100%' border='0' cellspacing='1' cellpadding='4'>
<tr><td class='forum2' width='59%'><p>Below you will find various pieces 
                          of documentation rescued from the (now defunct) bot 
                          epidemic site where the CGF mod called home. Whilst 
                          these documents are of excellent quality, it should 
                          be noted, that although LTKTBM shares many common factors 
                          with this mod, it uses an entirely different structure 
                          for handling much of the AI. </p>
                        <p>Weapon AI is a prime example, 
                          LTKTBM not only has the capability to choose the best 
                          current weapon, it can also select the best initial 
                          weapon for individual maps, the data for which is obtained 
                          by a learning algorithm not discussed here, the documentation 
                          for which is not available in the public domain. These 
                          documents are provided entirely for reference purposes, 
                          and the views and theories belong entirely to their 
                          author.</p>
                        <p>You can also view the <a href="http://www.cam-direct.co.uk/ltk/downloads/dl.php?id=114" target="_blank">cgf 
                          grenade handling</a> and <a href="http://www.cam-direct.co.uk/ltk/downloads/dl.php?id=115" target="_blank">terrain</a> 
                          pdf's by the same author.</font></p>
                        <p>This page is converted from <a href="http://www.cam-direct.co.uk/ltk/downloads/dl.php?id=116" target="_blank">the 
                          origonal page</a>.</p>
                        <p><B>CGF (AI) Weapon Handling</B> 
                        </p>
                        <HR color="#C0C0C0">
                         Last update: November 22, 
                        2000, by <A HREF="mailto:william@botepidemic.com">William</A>. 
                        </h3> 
                        <h5> <A NAME="h5_1">1. Tactical 
                          Shooters and Weapons</a> </h5>
                       Tactical shooter games typically 
                        are designed to provide a large arsenal of realistic weapons, 
                        each with their subtle but important characteristics. 
                        Some weapons are great for close combat, but are ineffective 
                        at long range. Others have great accuracy when firing 
                        in 3 round burst. Another type of weapon offers a telescope, 
                        but reloads slowly. Some have large recoil. Others feature 
                        large clips, etc. 
                        <p> The differences in weapons are that large and important 
                          that FAQ's for these tactical shooters typically need 
                          multiple pages of text to explain when (not) to use 
                          a specific weapon. 
                        <p> Thus, it is probably non-trivial for the AI to handle 
                          these weapons realistically and smart... 
                        <h5> <A NAME="h5_2">2. 'Open' Tactical 
                          Shooters and Weapon Code</a> </h5>
                       A number of 'open' 1st person shooters 
                        has been modified (mod-ed) by talented members of the 
                        gaming community to offer great and immersive realistic 
                        multi-player shooters. These mods have been programmed 
                        on top of (often) multi-player or (less often) single-player 
                        game logic provided by game developers. 
                        <p> Characteristic for these games and their game logic 
                          is: 
                        <ul>
                          <li>the original AI isn't too 
                            smart, and doesn't bother to think about differences 
                            as subtle as in realistic mods (because the original 
                            game allows 'respawn')                           <li>the weapon implementation 
                            solely keeps track of events important to the player 
                            (when to make sounds, what animation to display, etc.) 
                            
                        </ul>
                        <p>In other words, the information 
                          available in the game logic (either if-statements for 
                          Q2 based games, or weapon classes for HL based games), 
                          was never designed to assist the AI in figuring out 
                          how to handle a weapon realistically. <br>
                          This page documents the weapon model that enables the 
                          CGF AI to handle the weapons 'tactically'. </p>
                        <h5><A NAME="h5_3">3. AI Weapon 
                          Handling Analyzed</a> </h5>
                      In realistic shooters, the gamer 
                        (and preferably the AI): 
                        <ul>
                          <li>aims at a threat, and optionally 
                            fires the weapon 
                          <li>selects the best weapon for 
                            the job 
                          <li>selects the best weapon mode 
                            for the job <br>
                            (semi-automatic / full auto / zoom ...) 
                          <li>reloads a weapon that is empty, 
                            if possible 
                          <li>preloads weapons that aren't 
                            full (or prematurely reloads weapons that might become 
                            empty soon) 
                          <li>drops a weapon to pick up 
                            a better one 
                        </ul>
                        The actor (gamer or AI) takes a 
                        lot into account when deciding to fire, switch weapons, 
                        switch mode, (p)reload, etc.: 
                        <ul>
                          <li>ammo available in weapon 
                          <li>ammo clips carried by the 
                            AI 
                          <li>distance to threat 
                          <li>obstacles (thin walls, water) 
                            between AI and threat 
                          <li>threat visible or predicted 
                            
                          <li>weapon usage ('spray-n-pray', 
                            snipe, suppress, 'zoom-n-scan-n-snipe') 
                          <li>weapon capabilities (silenced, 
                            recoil, zoom, clip size) 
                          <li>other weapons in AI's arsenal 

                          <li>aim (reticule size, errors 
                            due to being hit) 
                          <li>threat's awareness of being 
                            aimed on 
                          <li>... 
                        </ul>
                        <p>This list clearly is too long 
                          to be dealt with by a couple of 'if-statements'. (And 
                          if that were possible, it would be a nightmare to add 
                          a new weapon). <br>
                          To record and be able to reason about these factors, 
                          we'd better make them explicit in our design.</p>
                        <h5><A NAME="h5_4">4. CGF AI Weapon 
                          Handling model (simplified)</a> </h5>
                       To reason about the use of weapons, 
                        the AI has explicit representations of all the important 
                        'objects': </font>
                        <ul>
                          <li> The AI character is an <i>Actor</i>, 
                            who holds ammo clips, and carriers a number of weapons. 
                            The <i>Actor</i> carries multiple <i>Weapons</i>, 
                            but has only one of them in his hands (selected). 
                                                      <li>The <i>Weapon</i> solely 
                            represents the state of a weapon carried by the <i>Actor</i>: 
                            the weapon holds some ammo, is in a mode, may be engaged 
                            in a burst. The <i>Weapon</i> is of a specific <i>WeaponType</i>. 
                                <li> The <i>WeaponType</i> super-class 
                            defines the possible characteristics of <i>WeaponType.</i> 
                            All <i>Weapons</i> of a <i>WeaponType</i> have a certain 
                            fitness for some usage, feature the weapon modes, 
                            and have ideal burst lengths. <br>
                            There sub-classes of <i>WeaponType</i> that define 
                            the exact properties and fitness for usage (as a virtual 
                            function), for example: 
                            <ul>
                              <li>the <i>Hand Gun</i>, which 
                                features single shot and automatic mode, and does 
                                not provide any restrictions on the burst length, 
                                since it doesn't have a significant recoil.                               <li>the <i>Assault Rifle</i>, 
                                which features 3 round bursts, automatic mode 
                                and a 3xzoom, and has some recoil (so it suggests 
                                a restricted burst length).                               <li>the <i>Squad Automatic 
                                Weapon</i>, which only has 'automatic' mode, and 
                                a significant recoil. It therefor is best fired 
                                in 5 round bursts. 
                            </ul>
                          <li> The <i>Threat</i> is a potential 
                            target to aim for. 
                          <li> Aiming isn't done instantaneously 
                            and perfectly (that wouldn't be realistic). Instead, 
                            the <i>Actor</i>'s aim depends on how well he sees 
                            the <i>Threat</i>, how long he has been looking at 
                            the <i>Threat</i>, etc. And if the <i>Threat</i> is 
                            hidden for just a moment by an obstacle, the <i>Actor</i> 
                            typically aims for the position the <i>Threat</i> 
                            will going to move to next, or the position the <i>Threat</i> 
                            will re-appear. </font>
                        </ul>
                        <h5><A NAME="h5_5">5. Weapon Selection 
                          using the Weapon Handling model</a></h5>
                        Instead of going through giant if-statements, 
                        weapon selection has become easier to write and understand: 
                                                <p>&nbsp; Weapon 
                          Actor::SelectBestWeapon(distance, usage)<br>
                          &nbsp; {<br>
                          &nbsp; &nbsp; bestweapon = 0;<br>
                          &nbsp; &nbsp; bestscore = 0;<br>
                          &nbsp; &nbsp; for each weapon carried<br>
                          &nbsp; &nbsp; {<br>
                          &nbsp; &nbsp; &nbsp; clips&nbsp; = inventory[weapon->GetAmmoType()];<br>
                          &nbsp; &nbsp; &nbsp; rounds = weapon->GetAmmo();<br>
                          &nbsp; &nbsp; &nbsp; score&nbsp; = weapon<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; ->GetWeaponType()<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ->GetFitnessForUsage(usage, 
                          distance,<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
                          &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
                          &nbsp; rounds, clips);<br>
                          &nbsp; &nbsp; &nbsp; <br>
                          &nbsp; &nbsp; &nbsp; if ( score > bestscore )<br>
                          &nbsp; &nbsp; &nbsp; {<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; bestscore = score;<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; bestweapon = weapon;<br>
                          &nbsp; &nbsp; &nbsp; }<br>
                          &nbsp; &nbsp; }<br>
                          &nbsp; &nbsp; return bestweapon;<br>
                          &nbsp; }<br>
      <br>
                          The real gain is not so much in the simple weapon selection 
                          algorithm, but in the fact that we can take care of 
                          all the specific weapon's pecularities in its own <i>WeaponType</i> 
                          function (a member function overriding the virtual member 
                          function in WeaponType):                         <p> &nbsp; float 
                          SquadAutomaticWeapon::GetFitnessForUsage<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (usage,distance, 
                          rounds, clips)<br>
                          &nbsp; {<br>
                          &nbsp; &nbsp; // not useful for anything<br>
                          &nbsp; &nbsp; // but suppression and direct fire<br>
                          &nbsp; &nbsp; if ( !(usage & (eDirectFire | eSuppression) 
                          )<br>
                          &nbsp; &nbsp; &nbsp; return 0;<br>
                          &nbsp; &nbsp;<br>
                          &nbsp; &nbsp; // fitness great for nearby<br>
                          &nbsp; &nbsp; // less for long distance<br>
                          &nbsp; &nbsp; float fitness;<br>
                          &nbsp; &nbsp; if ( distance < 100 )<br>
                          &nbsp; &nbsp; &nbsp; fitness = 1.0;<br>
                          &nbsp; &nbsp; else<br>
                          &nbsp; &nbsp; {<br>
                          &nbsp; &nbsp; &nbsp; fitness = 100 / distance;<br>
                          &nbsp; &nbsp;<br>
                          &nbsp; &nbsp; // correct for low on ammo<br>
                          &nbsp; &nbsp; // since reloading is slow<br>
                          &nbsp; &nbsp; if ( rounds < 10 )<br>
                          &nbsp; &nbsp; &nbsp; fitness *= 0.75;<br>
                          &nbsp; &nbsp;<br>
                          &nbsp; &nbsp; // if not much ammo in total<br>
                          &nbsp; &nbsp; // reduce fitness some more<br>
                          &nbsp; &nbsp; if ( (clips == 0) && (rounds < 50) )<br>
                          &nbsp; &nbsp; &nbsp; fitness *= 0.75;<br>
                          &nbsp; &nbsp; }<br>
                          &nbsp; &nbsp;<br>
                          &nbsp; &nbsp; return fitness;<br>
                          &nbsp; }<br>

                        <p>Note that the method deals in 
                          a simple and structured way with detailed properties 
                          of a 100 round belt-fed heavy machine gun. You don't 
                          run the risk of affecting other weapon's properties 
                          by changing it.                         <p> This same format, of having 
                          a dedicated method per weapon, allows you to take different 
                          matters into account when defining the fitness for a 
                          bolt-action sniper rifle. 
                        <p> The actual CGF for AQ2 code 
                          deals with more factors, including weapon add-ons (silencer, 
                          laser sight), weapon modes (3 round burst or full-auto, 
                          zoom levels), and game round duration (early in the 
                          game round, ammo conservation isn't that important). 

                        <p>The CGF <i>WeaponType</i> class 
                          also implements a lot more weapon properties, such as 
                          aiming preferences (hand guns cannot penetrate body 
                          armor, and should be aimed for the head or legs, sniper 
                          rifles aim for the largest portion of the body (torso), 
                          assault rifles on full auto aim for the feet since the 
                          muzzle will be kicked up, etc.). 
                        <h5> 
<A NAME="h5_6">6. Example Weapon 
                          Handling Behavior</a> </h5>
                 This weapon model also enables simple 
                        and understandable weapon handling code: 
                        <p> &nbsp; Weapon 
                          Actor::HandleWeapon(threattracking)<br>
                          &nbsp; {<br>
                          &nbsp; &nbsp; if ( !threattracking)<br>
                          &nbsp; &nbsp; { // no threat, take care of the weapons<br>
                          &nbsp; &nbsp; &nbsp; Weapon otherweapon;<br>
                          &nbsp; &nbsp; &nbsp; if ( SelectedWeapon()->IsEmpty() 
                          )<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; SelectedWeapon()->Reload();<br>
                          &nbsp; &nbsp; &nbsp; else<br>
                          &nbsp; &nbsp; &nbsp; if ( otherweapon = GetWeaponNeedingReload() 
                          )<br>
                          &nbsp; &nbsp; &nbsp; { // select now, reload when active<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; SelectWeapon(otherweapon);<br>
                          &nbsp; &nbsp; &nbsp; }<br>
                          &nbsp; &nbsp; }<br>
                          &nbsp; &nbsp; else<br>
                          &nbsp; &nbsp; { // threat! so aim and fire unless empty<br>
                          &nbsp; &nbsp; &nbsp; AimResult_t aim; // tells how the 
                          aim and weapon is<br>
                          &nbsp; &nbsp; &nbsp; // aiming also has bot turn towards 
                          target<br>
                          &nbsp; &nbsp; &nbsp; aim = SelectedWeapon()<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ->AimAndDecideToFire(threattracking);<br>
                          &nbsp; &nbsp; &nbsp; <br>
                          &nbsp; &nbsp; &nbsp; // test for good aim that isn't 
                          blocked<br>
                          &nbsp; &nbsp; &nbsp; if ( eFire == (aim & (eBlocked 
                          | eFire)) )<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SelectedWeapon->Fire();<br>
                          &nbsp; &nbsp; &nbsp; else<br>
                          &nbsp; &nbsp; &nbsp; if ( aim & (eEmpty) )<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReloadOrSwitchWeapon();<br>
                          &nbsp; &nbsp; &nbsp; else<br>
                          &nbsp; &nbsp; &nbsp; if ( aim & (eAim)) // thus eAim 
                          without eFire<br>
                          &nbsp; &nbsp; &nbsp; { // aims needs to improve or trigger 
                          should<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; // be released to reduce 
                          recoil (burst length)<br>
                          &nbsp; &nbsp; &nbsp; &nbsp; /* do nothing but keep aiming 
                          */<br>
                          &nbsp; &nbsp; &nbsp; }<br>
                          &nbsp; &nbsp; }<br>
                          &nbsp; }<br>
                          
                        <p> By having the <i>Weapon</i> 
                          and (not shown) the <i>WeaponType</i> handle the fire, 
                          we again can handle the peculiarities of the weapon 
                          in a single method. The code above suggests how a <i>Squad 
                          Automatic Weapon </i>can be used without the recoil 
                          growing too large. Probably every burstlength shots, 
                          the <i>Weapon</i> just does not return the eFire bit, 
                          and the Actor will ease of the trigger. 
                        <p>The actual CGF for AQ2 implementation 
                          (as released in December 99) deals with a number of 
                          other factors, including prediction of threat movement, 
                          prediction of threat 're-appear locations', weapon mode 
                          switching during the attack, scanning during sniping 
                          operations. It also knows dirty tricks such as taking 
                          the time to steady its aim when attacking a threat in 
                          the back (since the threat won't attack immediately)... 
                                                  <h5> <A NAME="h5_7">7. Extensions 
                          and Complications</a> </h5>
                        Depending on the weapon aspects 
                        being simulated, this design can be extended. Some extensions 
                        are straightforward, but other extensions really result 
                        in more complex designs. 
                        <p><b>Clips</b><br>
                          Some mods (including AQ2) have the Actor carry clips, 
                          not rounds. They reload clip by clip. Clips released 
                          from the weapons take 'home' the remaining rounds in 
                          that clip. Here, it makes sense to model the clips explicitly 
                          (since they probably can be picked up), and do the ammo 
                          computations with rounds in the weapon, and clip sizes. 

                        <p>Other mods (notably Counter-Strike) 
                          have 'virtual clips', and just shuffle additionals rounds 
                          (up to the clip size or ammo amount) into the weapon, 
                          when 'reloading' (CS seems to inherit the basic HL weapons 
                          code). Modeling the clips explicitly doesn't make that 
                          much sense. 
                        <p> <b>Reload Activities</b><br>
                          Most weapons will require one single (short) activity 
                          to reload it. There are, however, exceptions: (semi)-automatic 
                          shotguns and bolt-action (sniper) rifles typically combine 
                          internal ammo (round) storage with the ability to reload 
                          individual rounds. In that case, two modes of reloading 
                          are available: loading a single round, or loading a 
                          series of rounds. At ease, the Actor typically prefers 
                          loading a series of rounds, whereas in engaging a threat, 
                          the Actor will want to fire as soon as possible (after 
                          loading one single round). 
                        <p> <b>Ammo Types</b><br>
                          Some tactical shooters (notably R6: Rogue Spear) differentiate 
                          between different kinds of ammo. Examples including 
                          full metal jacket (FMJ) rounds that penetrate through 
                          targets and walls, jacketed hollow point (JHP) rounds 
                          that do not penetrate, subsonic rounds (less noise), 
                          slug / buckshot shotgun rounds, and tracer rounds. 
                        <p> Here it makes sense to model 
                          even the ammo types explicitly. 
                        <p> <b>'Power up' Weapons / Long 
                          reload times</b><br>
                          In a few shooters, some (but not all) weapons need a 
                          significant amount of time from the moment they are 
                          selected to the time they can be fired. Examples included: 
                          the gatling gun (HL TFC), heavy sniper rifles (R6 Rogue 
                          Spear), and hand grenades for which the pin is to be 
                          released first.                        <p> Similarly, once a weapon is 
                          being fired (i.e. the pin is pulled), it is important 
                          to continue to aim and fire in the direction intended. 

                        <p>Again, for the AI to take these 
                          into account, it is best to model these properties explicitly 
                          as an attribute / function call of the <i>Weapon</i>. 
                          In addition, the preferences for rapid weapon switching 
                          and activation should be taken into account when trying 
                          to select the best weapon (as an additional parameter 
                          in 'GetFitnessForUsage'). 
                        <p> <b>'Twin Weapons'</b><br>
                          Some game feature 'weapons' composed of two guns. The 
                          AQ2 and CS akimbo pistols of course come to mind. These 
                          akimbos can be treated as a single weapon with two clips 
                          and twice the rate of fire. They do not cause the AI 
                          problems in considering these guns.                         <p> For combinations of an assault 
                          rifle and grenade launcher (such as the M4/M203 in CGF), 
                          or an assault rifle and shotgun (in Delta Force), things 
                          get more complicated. <br>
                          A rifle/grenade launcher in theory is capable of direct 
                          (rifle / grenades) and arc trajectory (grenades, 'lobbed' 
                          over obstables) fire. Reload times differ for the clip 
                          and rifle grenade. A laser-sight and scope typically 
                          apply solely to the rifle, and is of little assistance 
                          in aiming the grenade launcher. <br>
                          Thus actual fitness for a task depends very much on 
                          the availability of (two different kinds of) ammo, and 
                          whether rounds of these types are in the weapon. <br>
                          I've tackled these twin weapons by taking into account 
                          two types of ammo in all <i>WeaponType</i> and <i>Weapon</i> 
                          instance interfaces (assuming weapons consuming yet 
                          another kind of ammo won't show up in a game). 
                        <p> <b>Arc Trajectory Weapons</b><br>
                          Already briefly mentioned above, arc trajectory weapons 
                          shoot projectiles that do not travel in an almost straight 
                          line, but instead along an arc (due to their slower 
                          speed). Examples include: hand grenades, throwing knifes, 
                          and rifle grenades. </font>
                        <p> These weapons, compared to rifles 
                          and hand guns, complicated matters by:                         <ul>
                          <li>having a range typically shorter 
                            than the map's dimensions 
                          <li>having the actual range (partially) 
                            depending on the height difference between the attacker 
                            and the target                          <li>having a minimum range (due 
                            to the damage radius) for rifle grenades and hand 
                            grenades                           <li>being able to seriously damage 
                            the target when positioned several meters away from 
                            the target's actual position (for grenades) 
                          <li>being able to cause friendly 
                            fire accidents (for grenades)                         </ul>
                        In other words, arc trajectory weapons 
                        are complicated to aim. Whereas for 'normal' rifles holds 
                        "what you see is what you can hit", trajectory weapons 
                        require checks for the complete trajectory. <br>
                        In addition, the <i>Actor</i> may be required to aim in 
                        a direction different from the target: notably the pitch 
                        (up / down) angle will be different, and to lob grenades 
                        through a window to a spot near enough to the target, 
                        the yaw (left / right) angle might be different as well. 
                        <p> Handling these trajectory weapons requires some special 
                          provisions in the aiming and aim evaluation code. </td></tr>
<tr><td class='mainfoot' colspan='5'>&nbsp;</td></tr> </table></td></tr></table><BR>
<div align="center"><script type="text/javascript"><!--
google_ad_client = "pub-7138831479577622";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "000000";
google_color_bg = "000000";
google_color_link = "FFFFFF";
google_color_text = "CCCCCC";
google_color_url = "999999";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
</td>
<!--end main text-->
	
	<td valign="top" width="20%">
	<!--start menu-->
<table width='100%' border='1' cellspacing='1' cellpadding='1' align='center' bordercolor='#aaaadd' bordercolorlight='#bbbbff' bordercolordark='#000033'><tr><td height='22' class='maintitle'><nobr><a href="http://www.cam-direct.co.uk/ltk/index2.php/Main/1">Main</a></nobr><br/>
<nobr><img src="/ltk/TMimages/branch.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/3">Media</a></nobr><br/>
<nobr><img src="/ltk/TMimages/branch.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/6">Downloads</a></nobr><br/>
<nobr><img src="/ltk/TMimages/branch.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/index2.php/News/11">News</a></nobr><br/>
<nobr><img src="/ltk/TMimages/branch.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/phpBB2/index.php">Forums</a></nobr><br/>
<nobr><img src="/ltk/TMimages/branch.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/index2.php/IRC/14">IRC</a></nobr><br/>
<nobr><img src="/ltk/TMimages/branch.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/index2.php/Plans/15">Plans</a></nobr><br/>
<nobr><img src="/ltk/TMimages/branchbottom.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/16">Developers</a></nobr><br/>
<nobr><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/branch.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/31">Game_Engine</a></nobr><br/>
<nobr><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/branchbottom.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/index2.php/Artificial_Intelligence/37">Artificial_Intelligence</a></nobr><br/>
<nobr><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/branch.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/index2.php/The_Borg_Matrix/28">The_Borg_Matrix</a></nobr><br/>
<nobr><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/branchbottom.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/index2.php/CGF-Documentation/38">CGF-Documentation</a></nobr><br/>
<nobr><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/branch.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/downloads/dl.php?id=114" target="_blank">CGF_Grenade_Handling</a></nobr><br/>
<nobr><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/linebottom.gif" width="20" height="20" align="top"/><img src="/ltk/TMimages/branchbottom.gif" width="20" height="20" align="top" border="0" /><a href="http://www.cam-direct.co.uk/ltk/downloads/dl.php?id=115" target="_blank">CGF_Terrain_Handling</a></nobr><br/>
</td></tr></table><br><table width='95%' align='center' border='0' cellspacing='1' cellpadding='0' bgcolor='#345487'><tr><td>
<table width='100%' border='0' cellspacing='0' cellpadding='3' class='maintitle'><tr><td class='maintitle'><img src='/forums/style_images/1/nav_m.gif' border='0'  alt='' width='8' height='8'></td>
<td width='100%' class='maintitle'>Word of the week</td>
</tr></table></td></tr><tr><td class='mainbg'><table width='100%' border='0' cellspacing='1' cellpadding='4'>
<tr><td class='forum2' width='59%'><a href='/ltk/index2.php/Dictionary/42/pyroxene/77992/#tbm_77992'><B>pyroxene</B><BR>any of a group of crystalline silicate mineral common in igneous and metamorphic rocks </a></td></tr>
<tr><td class='mainfoot' colspan='5'>&nbsp;</td></tr> </table></td></tr></table><BR>
	<table width="20%" border="0" cellspacing="2" cellpadding="0" align="left">



  <tr bgcolor="#000000"> 
    <td height="22"> 
      <div align="center"><b><font color="#FFFFFF">Respect to:</font><BR><a href="http://www.moddb.com/" target="_blank"><img src="/ltk/images/moddb.gif" width="88" height="31" border="0" alt="modDB.com - every game, every mod, one site... go figure!"></a></font></b><BR>
<a href="http://www.actiongames.co.uk/" target="_blank"><img src="/ltk/images/aglogo.gif" width="87" height="51" alt="Action Games"></a><BR>
<a href="http://www.aq2world.com" target="_blank"><img src="/ltk/images/button_aq2w.gif" width="88" height="31" alt="AQ2World"></a></div>
<a href="http://aqmd.telefragged.com/" target="_blank"><img src="/ltk/images/aqmd.gif" width="88" height="31" alt="AQMD"></a></div>
    </td>
  </tr>
  <tr bgcolor="#000000"> 
    <td> 
      <div align="center"><b><font color="#ffffff"><BR>Supporting:</font><BR> 
<a href=http://www.againsttcpa.com/what-is-tcpa.html target="_blank"><img src="/ltk/images/TCPA.gif" width="88" height="31" alt="Against TCPA"></a>
<a href="http://www.no2id.net/" style="position:relative;font-size:16px;color:white;background-color:black;font-family:'Trebuchet MS',Arial, Helvetica, sans-serif;font-weight:bold;padding:2px;border:#c00 solid 2px;text-decoration:none;" title="NO2ID - Stop ID cards & the database state">N<span style="color:#c00">&Oslash;</span>2ID</a></div>
    </td>
  </tr>
  
  <tr bgcolor="#000000"> 
    <td> 
	<div align="center"><b><font color="#ffffff"><BR>Donate:</font><BR> 
 <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_xclick">
<input type="hidden" name="business" value="markj.parker@ntlworld.com">
<input type="hidden" name="item_name" value="LTKTBM developement fund">
<input type="hidden" name="amount" value="5.00">
<input type="hidden" name="no_shipping" value="1">
<input type="hidden" name="return" value="http://www.cam-direct.co.uk/ltk/index2.php?location=paypal">
<input type="hidden" name="no_note" value="1">
<input type="hidden" name="currency_code" value="GBP">
<input type="hidden" name="tax" value="0">
<input type="hidden" name="bn" value="PP-DonationsBF">
<input type="image" src="http://www.cam-direct.co.uk/ltk/images/banner_intl.gif" border="0" name="submit" alt="Make payments with PayPal - it's fast, free and secure!">
<img alt="" border="0" src="https://www.paypal.com/en_GB/i/scr/pixel.gif" width="1" height="1">
</form></div><BR>
<script type="text/javascript"><!--
google_ad_client = "pub-7138831479577622";
google_ad_width = 110;
google_ad_height = 32;
google_ad_format = "110x32_as_rimg";
google_cpa_choice = "CAAQ463zzwEaCHRtWdgIj_1IKLPGvnUwAA";
google_ad_channel = "";
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
  </td>
  </tr>


</table>
<!--end menu-->

</td>
</tr>
</table>
<!--end layout table-->
<table width="100%" align="center" border="0" cellspacing="1" cellpadding="0">
<tr width="100%" bgcolor="#006600">
<td align="center" class="maintitle"><font size="+3"><b>
<table width="20%" border="2" cellspacing="2" cellpadding="2" align="center" bordercolor="#000000" bordercolorlight="#666666" bordercolordark="#666666">
  <tr bgcolor="#CCCCCC" class='maintitle'>
    <td height="22" class='maintitle'> 
      <div align="center"><b><font color="#FFFFFF"><a href="/ltk/index2.php?location=Main">MAIN</a></font></b></div>
    </td>
	<td height="22" class='maintitle'> 
      <div align="center"><b><font color="#FFFFFF"><a href="/ltk/index2.php?location=News">NEWS</a></font></b></div>
    </td>
	<td height="22" class='maintitle'> 
      <div align="center"><b><font color="#FFFFFF"><a href="/ltk/index2.php?location=IRC" target="_blank">IRC</a></font></b></div>
    </td>
    <td height="22" class='maintitle'> 
      <div align="center"><b><font color="#FFFFFF"><a href="/phpBB2/viewforum.php?f=21">BUGS</a></font></b></div>
    </td>
    <td height="22" class='maintitle'> 
      <div align="center"><b><font color="#FFFFFF"><a href="/ltk/index2.php?location=Plans">PLANS</a></font></b></div>
    </td>
    <td height="22" class='maintitle'> 
      <div align="center"><b><font color="#FFFFFF"><a href="/ltk/index2.php?location=LTKTBM&expand=6">DOWNLOADS 
        </a></font></b></div>
		</td>
    <td height="22" class='maintitle'> 
		<div align="center"><b><font color="#FFFFFF"><a href="/ltk/index2.php?location=Dictionary&expand=28">Developers(dictionary)
        </a></font></b></div>
    </td>
  </tr>
</table>
</b></font></td>
</tr>
</table>
<script language="JavaScript" type="text/javascript" src="/ltk/menu/wz_tooltip.js"></script>
</body>
</html>
